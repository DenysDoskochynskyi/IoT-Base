# Лабораторна робота №1  
**Предмет:** Основи проєктування IoT  
**Тема:** Ознайомлення з AWS IoT Core та MQTT-технологіями  

---

## Мета роботи
- Ознайомитися з технологіями побудови IoT-систем.  
- Навчитися налаштовувати віртуальні та реальні IoT-пристрої для обміну даними через MQTT.  
- Отримати практичний досвід роботи з **AWS IoT Core** та **HiveMQ**.  

---

## Варіант 1: AWS IoT Core (симуляція пристроїв)

### Теоретичні відомості
AWS IoT Core — це керований сервіс, який дозволяє підключати IoT-пристрої до хмари, керувати ними та отримувати від них дані у реальному часі.  
Пристрої (фізичні або симульовані) можуть надсилати повідомлення у вигляді MQTT або HTTPS-топіків.  

### Завдання
1. **Зареєструватися на AWS** (або використати наданий акаунт).  
2. **Створити IoT-пристрої** у сервісі AWS IoT Core (мінімум 3).  
   - Кожен пристрій повинен мати власний сертифікат та політику доступу.  
   - Рекомендується згрупувати пристрої за категоріями (наприклад: датчики руху, датчики вологості, магнітні датчики).  
3. **Завантажити та налаштувати клієнтські скрипти** (Python/Node.js), згенеровані AWS IoT Core.  
   - У кожному скрипті внести необхідні зміни (невеликі виправлення коду для стабільної роботи).  
   - Додати логіку для симуляції даних (наприклад, випадкові значення вологості, стан "ON/OFF" для датчика руху).  
4. **Запустити скрипти одночасно** та переконатися, що дані надсилаються у відповідні топіки.  
5. **Демонстрація результату:**  
   - Відкрити **IoT MQTT test client** у AWS Console.  
   - Показати отримані повідомлення від усіх пристроїв у реальному часі.  

### Очікуваний результат
- Наявність мінімум **трьох різних пристроїв**, що надсилають симульовані дані.  
- Кожен пристрій належить до певної **групи типів сенсорів**.  
- У консолі **AWS IoT MQTT test client** відображаються повідомлення від усіх пристроїв.  

### Приклад симульованих пристроїв
- `humidity_sensor.py` → надсилає випадкові значення вологості (%).  
- `motion_sensor.py` → надсилає стан `ON/OFF` залежно від випадкових подій.  
- `magnet_switch.py` → передає дані про розмикання/замикання (`OPEN/CLOSED`).  

---

## Варіант 2: ESP8266 + HiveMQ (реальний пристрій)

### Теоретичні відомості
MQTT — це легкий протокол обміну повідомленнями, який часто використовується в IoT. HiveMQ надає публічний брокер (`broker.hivemq.com`), що дозволяє легко перевіряти роботу пристроїв.  

### Завдання
1. Підключити ESP8266 до Wi-Fi.  
2. Налаштувати підключення до **HiveMQ** (публічний MQTT-брокер: `broker.hivemq.com`, порт `1883`).  
3. Написати код, який випадковим чином генерує дані та публікує їх у певний топік (наприклад: `iot/esp8266/lab1`).  
4. Перевірити надходження даних у **HiveMQ Web MQTT Client**.  

### Приклад коду (Arduino IDE, ESP8266 + PubSubClient)
```cpp
#include <ESP8266WiFi.h>
#include <PubSubClient.h>

const char* ssid = "YOUR_WIFI_SSID";
const char* password = "YOUR_WIFI_PASSWORD";
const char* mqtt_server = "broker.hivemq.com";

WiFiClient espClient;
PubSubClient client(espClient);

void setup_wifi() {
  delay(10);
  WiFi.begin(ssid, password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
  }
}

void reconnect() {
  while (!client.connected()) {
    if (client.connect("ESP8266Client")) {
      // Connected
    } else {
      delay(5000);
    }
  }
}

void setup() {
  setup_wifi();
  client.setServer(mqtt_server, 1883);
}

void loop() {
  if (!client.connected()) {
    reconnect();
  }
  client.loop();

  // Генерація випадкових даних
  int randomValue = random(0, 100);
  String payload = String(randomValue);
  client.publish("iot/esp8266/lab1", payload.c_str());

  delay(2000);
}
```

### Очікуваний результат
- ESP8266 підключається до Wi-Fi та HiveMQ.  
- У **HiveMQ Web MQTT Client** видно повідомлення з топіка `iot/esp8266/lab1`.  
- Є скріншоти:  
  - Підключення ESP (термінал Arduino IDE / Serial Monitor).  
  - Відображення повідомлень у HiveMQ Web Client.  

---

## Додаткові вказівки
- Використовуйте **креативний підхід**: створіть власні типи сенсорів (наприклад, “temperature”, “door sensor”, “light sensor”).  
- Скрипти, які генерує AWS, **працюють**, але потребують невеликих правок.  
- Якщо ви зіткнулися з труднощами, які не вдається вирішити самостійно — звертайтеся до викладача.  

---

## Звіт
У звіті повинно бути:  
1. Тема, мета роботи.  
2. Опис обраного варіанту (AWS чи ESP8266).  
3. Скріншоти процесу створення пристроїв / підключення ESP.  
4. Код або уривки коду симуляторів чи прошивки ESP.  
5. Скріншоти роботи **IoT MQTT test client** або HiveMQ.  
6. Висновки.  

---

## Контрольні питання
1. Що таке AWS IoT Core і для чого він використовується?  
2. Які протоколи можна використовувати для обміну повідомленнями у AWS IoT Core?  
3. Що таке MQTT і чому він популярний в IoT?  
4. Як створюється сертифікат для пристрою (у AWS)?  
5. Як перевірити, що ESP8266 успішно відправляє дані у HiveMQ?  
6. Чому важливо групувати пристрої за типами/топіками?  

---
